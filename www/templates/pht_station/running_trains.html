{% extends "pht_station/master.html" %}


{% block body %}
  <h2>Registry: Train Images</h2>

  <div id="main_content">
    <div class="row">
      <div class="col-sm-2">
      </div>
      <div class="col-sm-10">
      </div>
    </div>
      <div>
          Hello World
      </div>
{#    <table id="pht_station_repotags"#}
{#           class="table table-striped table-bordered table-hover">#}
{#        <thead>#}
{#            <tr>#}
{#                <th>Repository</th>#}
{#                <th>Description</th>#}
{#                <th>Tag</th>#}
{#                <th>Size</th>#}
{#                <th>Created</th>#}
{#            </tr>#}
{#        </thead>#}
{#        <tbody>#}
{#        {% for r in repotags %}#}
{#            <tr>#}
{#                <td>{{ r.repo.name }}</td>#}
{#                <td>{{ r.repo.description }}</td>#}
{#                <td>{{ r.tag.name }}</td>#}
{#                <td>{{ r.tag.size }}</td>#}
{#                <td>{{ r.tag.created }}</td>#}
{#            </tr>#}
{#        {% endfor %}#}
{#        </tbody>#}
{#    </table>#}
  </div>
{% endblock %}

{##}
{#{% block tail %}#}
{#  {{ super() }}#}
{#  <script src="{{ url_for('static', filename='d3.v3.min.js') }}"></script>#}
{#  <script src="{{ url_for('static', filename='jquery.dataTables.min.js') }}"></script>#}
{#  <script src="{{ url_for('static', filename='dataTables.select.min.js') }}"></script>#}
{#  <script src="{{ url_for('static', filename='bootstrap-toggle.min.js') }}"></script>#}
{#  <script src="{{ url_for('static', filename='bootstrap3-typeahead.min.js') }}"></script>#}
{#    <script>#}
{#    // TODO Refactor#}
{#    let selectedRepo = undefined;#}
{#    $(function(){#}
{#      const repos_table = $('#pht_station_repositories').DataTable({#}
{#          select: true,#}
{#          searching: false,#}
{#          paging: false,#}
{#      });#}
{#      let tags_table = $('#pht_station_tags').DataTable({#}
{#          searching: false,#}
{#          paging: false,#}
{#      });#}
{#      tags_table.on('draw.dt', function () {#}
{#            tags_table.rows().every( function ( rowIdx, tableLoop, rowLoop ) {#}
{#                const {name, digest} = this.data();#}
{#                const links = this.node().lastChild;#}
{#                links.innerHTML = `<a href="{{ url_for('registry.train')}}"#}
{#                   onclick="return confirmTrain('${name}', '${digest}')">#}
{#                    <span class="glyphicon glyphicon-play-circle" aria-hidden="true" data-original-title="Trigger Dag">#}
{#                    </span>#}
{#                </a>`#}
{#        });#}
{#      });#}
{##}
{#      // Click handler for rows on the 'repositories' table#}
{#      $('#pht_station_repositories tbody').on('click', 'tr', function() {#}
{##}
{#         selectedRepo = repos_table.row(this).data()[0];#}
{#         tags_table.destroy();#}
{#         tags_table = $('#pht_station_tags').DataTable({#}
{#             searching: false,#}
{#             paging: false,#}
{#             ajax: {#}
{#                 url: "{{ url_for('registry.get_repository')}}" + `/${selectedRepo}/tag`,#}
{#                 dataSrc: 'tags'#}
{#             },#}
{#             columns: [#}
{#                 {data: "name"},#}
{#                 {#}
{#                     data: "digest",#}
{#                     visible: false#}
{#                 },#}
{#                 {data: "size"},#}
{#                 {data: "architecture"},#}
{#                 {data: "os"},#}
{#                 {data: "author"},#}
{#                 {data: "created"},#}
{#                 {defaultContent: ""} // For the links#}
{#             ]#}
{#         });#}
{#      });#}
{#    });#}
{##}
{#    function confirmTrain(tag, digest){#}
{#        if (confirm("Are you sure?")) {#}
{#            $.ajax({#}
{#                type: "POST",#}
{#                url: "{{ url_for('registry.train') }}",#}
{#                dataType: 'json',#}
{#                async: false,#}
{#                contentType: 'application/json',#}
{#                data: JSON.stringify({tag, digest, repo: selectedRepo}),#}
{#                success: () => alert('Successfully accepted train!')#}
{#            })#}
{#        }#}
{#        // prevents following the link in <a> tag#}
{#        return false;#}
{#    }#}
{#    </script>#}
{#{% endblock %}#}
